# LivePush UI 设计文档

## 1. 设计规范

### 1.1 设计系统

基于 Material Design 3 设计系统，使用动态颜色主题。

### 1.2 颜色系统

```
┌─────────────────────────────────────────────────────────────────┐
│                        Color Palette                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Primary Colors (品牌色)                                         │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                       │
│  │ Primary  │  │ OnPrimary│  │ Primary  │                       │
│  │ #6750A4  │  │ #FFFFFF  │  │ Container│                       │
│  │          │  │          │  │ #EADDFF  │                       │
│  └──────────┘  └──────────┘  └──────────┘                       │
│                                                                  │
│  Status Colors (状态色)                                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                       │
│  │  Live    │  │  Error   │  │  Success │                       │
│  │ #FF4444  │  │ #BA1A1A  │  │ #4CAF50  │                       │
│  │  直播中  │  │   错误   │  │   成功   │                       │
│  └──────────┘  └──────────┘  └──────────┘                       │
│                                                                  │
│  Neutral Colors (中性色)                                         │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐        │
│  │ Surface  │  │OnSurface │  │ Outline  │  │  Surface │        │
│  │ #FFFBFE  │  │ #1C1B1F  │  │ #79747E  │  │ Variant  │        │
│  │          │  │          │  │          │  │ #E7E0EC  │        │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘        │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 1.3 排版系统

```
Typography Scale (Material 3)
─────────────────────────────────────────
Display Large    57sp / 64 line height
Display Medium   45sp / 52 line height
Display Small    36sp / 44 line height
─────────────────────────────────────────
Headline Large   32sp / 40 line height
Headline Medium  28sp / 36 line height
Headline Small   24sp / 32 line height
─────────────────────────────────────────
Title Large      22sp / 28 line height
Title Medium     16sp / 24 line height  ← 常用标题
Title Small      14sp / 20 line height
─────────────────────────────────────────
Body Large       16sp / 24 line height  ← 正文
Body Medium      14sp / 20 line height
Body Small       12sp / 16 line height
─────────────────────────────────────────
Label Large      14sp / 20 line height  ← 按钮文字
Label Medium     12sp / 16 line height
Label Small      11sp / 16 line height  ← 辅助文字
```

### 1.4 间距系统

```
Spacing Scale
─────────────────
4dp   - xs (极小)
8dp   - sm (小)
12dp  - md (中)
16dp  - lg (大)     ← 常用
24dp  - xl (特大)
32dp  - xxl
48dp  - xxxl
```

### 1.5 圆角规范

```
Corner Radius
─────────────────
4dp   - Extra Small (小按钮)
8dp   - Small (卡片)
12dp  - Medium (输入框)
16dp  - Large (面板)
28dp  - Extra Large (FAB)
Full  - 圆形按钮
```

---

## 2. 组件设计

### 2.1 推流状态指示器

```
┌─────────────────────────────────────────────────────────────────┐
│                    Stream Status Indicator                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  空闲状态                                                        │
│  ┌────────────────────┐                                         │
│  │  ○  未连接          │   灰色圆点 + 文字                       │
│  └────────────────────┘                                         │
│                                                                  │
│  连接中                                                          │
│  ┌────────────────────┐                                         │
│  │  ◐  连接中...      │   旋转动画 + 文字                        │
│  └────────────────────┘                                         │
│                                                                  │
│  直播中                                                          │
│  ┌────────────────────┐                                         │
│  │  🔴 直播中 00:05:32│   红色闪烁圆点 + 计时                    │
│  └────────────────────┘                                         │
│                                                                  │
│  重连中                                                          │
│  ┌────────────────────┐                                         │
│  │  ⟳  重连中 (2/5)   │   旋转图标 + 重试次数                    │
│  └────────────────────┘                                         │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 推流统计面板

```
┌─────────────────────────────────────────────────────────────────┐
│                     Stream Stats Panel                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  紧凑模式 (推流页显示)                                            │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  ↑ 2.1 Mbps   30fps   120ms   0.0%                      │    │
│  │    码率       帧率    延迟    丢帧                        │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  展开模式 (点击展开)                                              │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  视频                                                    │    │
│  │  ├─ 分辨率: 1280 × 720                                   │    │
│  │  ├─ 编码器: H.264 (Hardware)                             │    │
│  │  ├─ 码率: 2.1 Mbps                                       │    │
│  │  └─ 帧率: 30 fps                                         │    │
│  │                                                          │    │
│  │  音频                                                    │    │
│  │  ├─ 采样率: 44100 Hz                                     │    │
│  │  ├─ 编码器: AAC                                          │    │
│  │  └─ 码率: 128 Kbps                                       │    │
│  │                                                          │    │
│  │  网络                                                    │    │
│  │  ├─ 延迟: 120 ms                                         │    │
│  │  ├─ 丢帧: 0.0%                                           │    │
│  │  └─ 已发送: 156.7 MB                                     │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2.3 控制按钮组

```
┌─────────────────────────────────────────────────────────────────┐
│                     Control Button Bar                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  圆形图标按钮 (48dp × 48dp)                                      │
│                                                                  │
│    ┌────┐  ┌────┐  ┌────┐  ┌────┐  ┌────┐                      │
│    │ 🔄 │  │ 🔦 │  │ 🎤 │  │ ✨ │  │ ⏹️ │                      │
│    │    │  │    │  │    │  │    │  │    │                      │
│    └────┘  └────┘  └────┘  └────┘  └────┘                      │
│    切换    闪光灯   静音    美颜    停止                          │
│                                                                  │
│  状态变化:                                                       │
│  • 默认: Surface Container 背景                                  │
│  • 激活: Primary Container 背景                                  │
│  • 禁用: 30% 透明度                                              │
│                                                                  │
│  示例 - 静音按钮:                                                │
│  ┌────┐  →  ┌────┐                                              │
│  │ 🎤 │     │ 🔇 │   图标变化 + 背景变红                         │
│  │ ON │     │OFF │                                              │
│  └────┘     └────┘                                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2.4 推流地址输入

```
┌─────────────────────────────────────────────────────────────────┐
│                     URL Input Field                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  默认状态 (带粘贴和扫码按钮)                                      │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  📡 推流地址                                             │    │
│  │  ┌─────────────────────────────────────┬─────┬─────┐    │    │
│  │  │ rtmp://                             │ 📋  │ 📷  │    │    │
│  │  └─────────────────────────────────────┴─────┴─────┘    │    │
│  │  支持 RTMP、RTMPS、WebSocket 协议                        │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  按钮说明:                                                       │
│  📋 粘贴按钮 - 从剪贴板读取并填入                                │
│  📷 扫码按钮 - 打开扫码页面                                      │
│                                                                  │
│  输入状态                                                        │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  📡 推流地址                                             │    │
│  │  ┌─────────────────────────────────────┬─────┬─────┐    │    │
│  │  │ rtmp://live.example.com/app/str|    │ 📋  │ 📷  │    │    │
│  │  └─────────────────────────────────────┴─────┴─────┘    │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  错误状态                                                        │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  📡 推流地址                                             │    │
│  │  ┌─────────────────────────────────────┬─────┬─────┐    │    │
│  │  │ invalid-url                         │ 📋  │ 📷  │    │    │
│  │  └─────────────────────────────────────┴─────┴─────┘    │    │
│  │  ⚠️ 请输入有效的推流地址                                  │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2.5 协议选择器

```
┌─────────────────────────────────────────────────────────────────┐
│                    Protocol Selector                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Segmented Button 样式                                           │
│                                                                  │
│  ┌────────────────────────────────────────────────┐             │
│  │ ┌──────────────────┐┌──────────────────┐       │             │
│  │ │      RTMP        ││     WebRTC       │       │             │
│  │ │   ● 已选择       ││    ○ 未选择      │       │             │
│  │ └──────────────────┘└──────────────────┘       │             │
│  └────────────────────────────────────────────────┘             │
│                                                                  │
│  切换动画: 选中项滑动 + 颜色渐变                                  │
│                                                                  │
│  选中状态: Primary Container 背景 + OnPrimaryContainer 文字      │
│  未选中:   透明背景 + OnSurface 文字                             │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. 页面详细设计

### 3.1 启动页 (Splash Screen)

```
┌─────────────────────────────────────────┐
│                                         │
│                                         │
│                                         │
│                                         │
│                                         │
│           ┌─────────────┐               │
│           │             │               │
│           │    LOGO     │               │
│           │             │               │
│           └─────────────┘               │
│                                         │
│             LivePush                    │  ← Display Small
│                                         │
│        专业直播推流工具                   │  ← Body Medium, 50% opacity
│                                         │
│                                         │
│                                         │
│                                         │
│              ◐ 加载中                   │  ← 启动动画
│                                         │
│                                         │
│                                         │
│                                         │
│           v1.0.0                        │  ← Label Small, 底部
└─────────────────────────────────────────┘

动画效果:
1. Logo 从 0.8x 缩放到 1x (300ms, EaseOut)
2. 文字淡入 (200ms delay, 300ms duration)
3. 加载指示器旋转
```

### 3.2 首页 (Home Screen)

```
┌─────────────────────────────────────────┐
│ ≡  LivePush                        ⚙️  │  ← TopAppBar, Title Large
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │        [相机预览区域]            │   │  ← 16:9 比例, 圆角 16dp
│  │         小窗预览                 │   │
│  │                                 │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  推流地址                               │  ← Label Large
│  ┌─────────────────────────────────┐   │
│  │ rtmp://                    [📋] │   │  ← OutlinedTextField
│  └─────────────────────────────────┘   │
│                                         │
│  推流协议                               │  ← Label Large
│  ┌───────────────┐ ┌───────────────┐   │
│  │     RTMP      │ │    WebRTC     │   │  ← SegmentedButton
│  │      ●        │ │      ○        │   │
│  └───────────────┘ └───────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │          开始推流                │   │  ← FilledButton, 56dp height
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ─────────── 最近使用 ───────────      │  ← Divider + Label
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 📡 rtmp://live.xxx.com/app/s1   │   │  ← ListItem
│  │    2024-12-30 10:30             │   │
│  ├─────────────────────────────────┤   │
│  │ 📡 rtmp://live.xxx.com/app/s2   │   │
│  │    2024-12-29 15:20             │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### 3.3 推流页 (Stream Screen)

```
┌─────────────────────────────────────────┐
│ ←  00:05:32               🔴 直播中     │  ← TopAppBar, 半透明
├─────────────────────────────────────────┤
│                                         │
│                                         │
│                                         │
│                                         │
│                                         │
│         [全屏相机预览]                   │  ← 全屏预览
│                                         │
│                                         │
│                                         │
│                                         │
│                                         │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │ ↑2.1Mbps  30fps  120ms  0.0%   │   │  ← 状态栏, 半透明背景
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│                                         │
│    ┌──┐   ┌──┐   ┌──┐   ┌──┐   ┌──┐   │
│    │🔄│   │🔦│   │🎤│   │✨│   │⏹️│   │  ← 控制按钮
│    └──┘   └──┘   └──┘   └──┘   └──┘   │
│    切换   闪光    静音   美颜   停止    │  ← Label Small
│                                         │
└─────────────────────────────────────────┘

交互说明:
• 点击预览区域: 显示/隐藏控制栏 (3秒自动隐藏)
• 双击预览区域: 切换前后摄像头
• 长按预览区域: 手动对焦
• 双指缩放: 调整焦距

横屏模式:
┌─────────────────────────────────────────────────────────────────────────┐
│ ←  00:05:32                               🔴 直播中                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                │        │
│                                                                │  ┌──┐  │
│                                                                │  │🔄│  │
│                                                                │  └──┘  │
│              [全屏相机预览 - 横屏]                               │  ┌──┐  │
│                                                                │  │🔦│  │
│                                                                │  └──┘  │
│                                                                │  ┌──┐  │
│                                                                │  │🎤│  │
│                                                                │  └──┘  │
│                                                                │  ┌──┐  │
│ ┌────────────────────────────────────────────────────────────┐ │  │✨│  │
│ │ ↑2.1Mbps  30fps  120ms  0.0%                               │ │  └──┘  │
│ └────────────────────────────────────────────────────────────┘ │  ┌──┐  │
│                                                                │  │⏹️│  │
│                                                                │  └──┘  │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.4 美颜面板 (Beauty Panel)

```
┌─────────────────────────────────────────┐
│                                         │
│         [相机预览区域]                   │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│                                         │  ← BottomSheet
│  美颜                            [关闭] │  ← Title Medium
│                                         │
│  磨皮                                   │  ← Label Medium
│  ○────────────●──────────────○   70%   │  ← Slider
│                                         │
│  美白                                   │
│  ○──────────────●────────────○   50%   │
│                                         │
│  红润                                   │
│  ○──●────────────────────────○   20%   │
│                                         │
├─────────────────────────────────────────┤
│  滤镜                                   │  ← Title Medium
│                                         │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐   │
│  │    │ │    │ │    │ │    │ │    │   │  ← HorizontalPager
│  │原图│ │清新│ │复古│ │黑白│ │暖色│   │
│  │ ●  │ │    │ │    │ │    │ │    │   │
│  └────┘ └────┘ └────┘ └────┘ └────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │            重置                  │   │  ← TextButton
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### 3.5 设置页 (Settings Screen)

```
┌─────────────────────────────────────────┐
│ ←  设置                                 │  ← TopAppBar
├─────────────────────────────────────────┤
│                                         │
│  视频设置                               │  ← 分组标题, Label Large
│  ┌─────────────────────────────────┐   │
│  │ 分辨率                           │   │
│  │ 1280 × 720                   ▼  │   │  ← DropdownMenu
│  ├─────────────────────────────────┤   │
│  │ 帧率                             │   │
│  │ 30 fps                       ▼  │   │
│  ├─────────────────────────────────┤   │
│  │ 码率                             │   │
│  │ 2.0 Mbps                     ▼  │   │
│  ├─────────────────────────────────┤   │
│  │ 编码器                           │   │
│  │ H.264                        ▼  │   │
│  └─────────────────────────────────┘   │
│                                         │
│  音频设置                               │
│  ┌─────────────────────────────────┐   │
│  │ 采样率                           │   │
│  │ 44100 Hz                     ▼  │   │
│  ├─────────────────────────────────┤   │
│  │ 码率                             │   │
│  │ 128 Kbps                     ▼  │   │
│  ├─────────────────────────────────┤   │
│  │ 声道                             │   │
│  │ 立体声                        ▼  │   │
│  └─────────────────────────────────┘   │
│                                         │
│  网络设置                               │
│  ┌─────────────────────────────────┐   │
│  │ 自动重连                         │   │
│  │                              🔘  │   │  ← Switch
│  ├─────────────────────────────────┤   │
│  │ 最大重连次数                      │   │
│  │ 5 次                         ▼  │   │
│  ├─────────────────────────────────┤   │
│  │ 连接超时                         │   │
│  │ 10 秒                        ▼  │   │
│  └─────────────────────────────────┘   │
│                                         │
│  高级设置                               │
│  ┌─────────────────────────────────┐   │
│  │ 硬件编码                         │   │
│  │                              🔘  │   │
│  ├─────────────────────────────────┤   │
│  │ 降噪                             │   │
│  │                              🔘  │   │
│  ├─────────────────────────────────┤   │
│  │ 关键帧间隔                        │   │
│  │ 2 秒                         ▼  │   │
│  └─────────────────────────────────┘   │
│                                         │
│  关于                                   │
│  ┌─────────────────────────────────┐   │
│  │ 版本                             │   │
│  │ v1.0.0                       >  │   │
│  ├─────────────────────────────────┤   │
│  │ 开源许可                         │   │
│  │                              >  │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### 3.6 扫码页 (QR Scanner Screen)

```
┌─────────────────────────────────────────┐
│ ←  扫描二维码                            │  ← TopAppBar
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │  ┌───┐                   ┌───┐ │   │
│  │  │   │                   │   │ │   │  ← 扫描框四角
│  │  └───┘                   └───┘ │   │
│  │                                 │   │
│  │         [相机预览]              │   │  ← 全屏相机预览
│  │       ════════════             │   │  ← 扫描线动画
│  │                                 │   │
│  │  ┌───┐                   ┌───┐ │   │
│  │  │   │                   │   │ │   │
│  │  └───┘                   └───┘ │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│      将二维码放入框内，自动扫描          │  ← 提示文字, Body Medium
│                                         │
│  ┌─────────────────────────────────┐   │
│  │        🔦  打开闪光灯            │   │  ← OutlinedButton
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │        📁  从相册选择            │   │  ← TextButton
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘

扫描成功交互:
1. 震动反馈 (50ms)
2. 扫描框变绿 + 缩放动画
3. 短暂显示识别到的内容
4. 自动返回首页并填入地址

闪光灯按钮状态:
• 关闭: "🔦 打开闪光灯"
• 开启: "🔦 关闭闪光灯" (Primary 背景)
```

---

## 4. 交互动画

### 4.1 页面转场

| 转场类型 | 动画效果 | 时长 |
|----------|----------|------|
| 首页 → 推流页 | SharedElement (预览窗口放大) | 400ms |
| 首页 → 设置页 | SlideIn (从右侧滑入) | 300ms |
| 首页 → 扫码页 | SlideIn (从右侧滑入) | 300ms |
| 扫码成功 → 首页 | SlideOut + 填入动画 | 250ms |
| 返回 | SlideOut (向右滑出) | 250ms |
| 美颜面板 | BottomSheet (从底部弹出) | 300ms |

### 4.2 状态变化动画

```
推流按钮状态变化:
┌─────────┐     ┌─────────┐     ┌─────────┐
│ 开始推流 │ ──▶ │ 连接中.. │ ──▶ │ 停止推流 │
│ Primary │     │ Loading │     │  Error  │
└─────────┘     └─────────┘     └─────────┘
    ↑                               │
    └───────────────────────────────┘

动画:
• 文字渐变 (crossfade)
• 背景色渐变
• 按钮缩放反馈 (0.95x → 1x)
```

### 4.3 手势交互

| 手势 | 位置 | 动作 |
|------|------|------|
| 单击 | 预览区域 | 显示/隐藏控制栏 |
| 双击 | 预览区域 | 切换摄像头 |
| 长按 | 预览区域 | 手动对焦 (显示对焦框) |
| 双指缩放 | 预览区域 | 调整焦距 |
| 左滑 | 控制栏 | 快速静音 |
| 上滑 | 状态栏 | 展开详细统计 |

---

## 5. 响应式布局

### 5.1 屏幕断点

```
Compact:   < 600dp   (手机竖屏)
Medium:    600-840dp (手机横屏 / 折叠屏)
Expanded:  > 840dp   (平板)
```

### 5.2 布局适配

```
Compact (竖屏):
┌─────────────────┐
│     预览        │
│                 │
├─────────────────┤
│     控件        │
└─────────────────┘

Medium (横屏):
┌─────────────────────────────────┐
│                          │      │
│        预览              │ 控件 │
│                          │      │
└─────────────────────────────────┘

Expanded (平板):
┌─────────────────────────────────────────┐
│              │                │         │
│    侧边栏    │      预览      │  控件   │
│              │                │         │
└─────────────────────────────────────────┘
```

---

## 6. 无障碍设计

### 6.1 Content Description

| 元素 | 描述 |
|------|------|
| 开始推流按钮 | "开始推流，双击激活" |
| 切换摄像头 | "切换前后摄像头" |
| 静音按钮 | "麦克风静音，当前已开启" |
| 美颜滑块 | "磨皮强度，当前 70%" |

### 6.2 焦点顺序

```
首页焦点顺序:
1. 推流地址输入框
2. RTMP 协议选择
3. WebRTC 协议选择
4. 开始推流按钮
5. 历史记录列表
6. 设置按钮
```

---

## 7. 深色模式

```
┌─────────────────────────────────────────────────────────────────┐
│                     Dark Theme Colors                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Surface:          #1C1B1F  (几乎黑色)                          │
│  OnSurface:        #E6E1E5  (浅灰文字)                          │
│  SurfaceVariant:   #49454F  (卡片背景)                          │
│  Primary:          #D0BCFF  (浅紫色)                            │
│  PrimaryContainer: #4F378B  (深紫容器)                          │
│                                                                  │
│  预览页深色模式:                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                   (相机预览)                             │    │
│  │                                                          │    │
│  │  ┌────────────────────────────────────────────────────┐ │    │
│  │  │ ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ │ │    │
│  │  │          (半透明黑色状态栏)                         │ │    │
│  │  └────────────────────────────────────────────────────┘ │    │
│  │  ┌────────────────────────────────────────────────────┐ │    │
│  │  │                                                    │ │    │
│  │  │   (深色半透明控制栏)                                │ │    │
│  │  │                                                    │ │    │
│  │  └────────────────────────────────────────────────────┘ │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```
